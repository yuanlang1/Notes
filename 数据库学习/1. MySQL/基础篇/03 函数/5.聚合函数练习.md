# 聚合函数练习

- [聚合函数练习](#聚合函数练习)
  - [1.查询公司员工工资的最大值，最小值，平均值，总和](#1查询公司员工工资的最大值最小值平均值总和)
  - [2. 查询各job\_id的员工工资的最大值，最小值，平均值，总和](#2-查询各job_id的员工工资的最大值最小值平均值总和)
  - [3. 选择具有各个job\_id的员工人数](#3-选择具有各个job_id的员工人数)
  - [4.查询员工最高工资和最低工资的差距（DIFFERENCE）](#4查询员工最高工资和最低工资的差距difference)
  - [5. 查询各个管理者手下员工的最低工资，其中最低工资不能低于6000，没有管理者的员工不计算在内](#5-查询各个管理者手下员工的最低工资其中最低工资不能低于6000没有管理者的员工不计算在内)
  - [6. 查询所有部门的名字，location\_id，员工数量和平均工资，并按平均工资降序](#6-查询所有部门的名字location_id员工数量和平均工资并按平均工资降序)
  - [7. 查询每个工种、每个部门的部门名、工种名和最低工资](#7-查询每个工种每个部门的部门名工种名和最低工资)

---

## 1.查询公司员工工资的最大值，最小值，平均值，总和

```sql
select MAX(salary),MIN(salary),AVG(salary),SUM(salary)
from employees;

结果：
+-------------+-------------+-------------+-------------+
| MAX(salary) | MIN(salary) | AVG(salary) | SUM(salary) |
+-------------+-------------+-------------+-------------+
|    24000.00 |     2100.00 | 6461.682243 |   691400.00 |
+-------------+-------------+-------------+-------------+
```

---

## 2. 查询各job_id的员工工资的最大值，最小值，平均值，总和

```sql
select job_id,MAX(salary),MIN(salary),AVG(salary),SUM(salary)
from employees
group by job_id;
结果：
+------------+-------------+-------------+--------------+-------------+
| job_id     | MAX(salary) | MIN(salary) | AVG(salary)  | SUM(salary) |
+------------+-------------+-------------+--------------+-------------+
| AC_ACCOUNT |     8300.00 |     8300.00 |  8300.000000 |     8300.00 |
| AC_MGR     |    12000.00 |    12000.00 | 12000.000000 |    12000.00 |
| AD_ASST    |     4400.00 |     4400.00 |  4400.000000 |     4400.00 |
| AD_PRES    |    24000.00 |    24000.00 | 24000.000000 |    24000.00 |
| AD_VP      |    17000.00 |    17000.00 | 17000.000000 |    34000.00 |
| FI_ACCOUNT |     9000.00 |     6900.00 |  7920.000000 |    39600.00 |
| FI_MGR     |    12000.00 |    12000.00 | 12000.000000 |    12000.00 |
| HR_REP     |     6500.00 |     6500.00 |  6500.000000 |     6500.00 |
| IT_PROG    |     9000.00 |     4200.00 |  5760.000000 |    28800.00 |
| MK_MAN     |    13000.00 |    13000.00 | 13000.000000 |    13000.00 |
| MK_REP     |     6000.00 |     6000.00 |  6000.000000 |     6000.00 |
| PR_REP     |    10000.00 |    10000.00 | 10000.000000 |    10000.00 |
| PU_CLERK   |     3100.00 |     2500.00 |  2780.000000 |    13900.00 |
| PU_MAN     |    11000.00 |    11000.00 | 11000.000000 |    11000.00 |
| SA_MAN     |    14000.00 |    10500.00 | 12200.000000 |    61000.00 |
| SA_REP     |    11500.00 |     6100.00 |  8350.000000 |   250500.00 |
| SH_CLERK   |     4200.00 |     2500.00 |  3215.000000 |    64300.00 |
| ST_CLERK   |     3600.00 |     2100.00 |  2785.000000 |    55700.00 |
| ST_MAN     |     8200.00 |     5800.00 |  7280.000000 |    36400.00 |
+------------+-------------+-------------+--------------+-------------+
```

---

## 3. 选择具有各个job_id的员工人数

```sql
先找出job_id的分组，然后求job_id分组的COUNT
select job_id,count(*)
from employees
group by job_id;

结果：
+------------+----------+
| job_id     | count(*) |
+------------+----------+
| AC_ACCOUNT |        1 |
| AC_MGR     |        1 |
| AD_ASST    |        1 |
| AD_PRES    |        1 |
| AD_VP      |        2 |
| FI_ACCOUNT |        5 |
| FI_MGR     |        1 |
| HR_REP     |        1 |
| IT_PROG    |        5 |
| MK_MAN     |        1 |
| MK_REP     |        1 |
| PR_REP     |        1 |
| PU_CLERK   |        5 |
| PU_MAN     |        1 |
| SA_MAN     |        5 |
| SA_REP     |       30 |
| SH_CLERK   |       20 |
| ST_CLERK   |       20 |
| ST_MAN     |        5 |
+------------+----------+
```

---

## 4.查询员工最高工资和最低工资的差距（DIFFERENCE）

```sql
select MAX(salary)-MIN(salary) "DIFFERENCE"
from employees;

结果：
+------------+
| DIFFERENCE |
+------------+
|   21900.00 |
+------------+
```

---

## 5. 查询各个管理者手下员工的最低工资，其中最低工资不能低于6000，没有管理者的员工不计算在内

```sql
select manager_id,MIN(salary)
from employees
where  manager_id is not NULL
group by manager_id;
having MIN(salary)>6000;

结果：
+------------+-------------+
| manager_id | MIN(salary) |
+------------+-------------+
|        100 |     5800.00 |
|        101 |     4400.00 |
|        102 |     9000.00 |
|        103 |     4200.00 |
|        108 |     6900.00 |
|        114 |     2500.00 |
|        120 |     2200.00 |
|        121 |     2100.00 |
|        122 |     2200.00 |
|        123 |     2500.00 |
|        124 |     2500.00 |
|        145 |     7000.00 |
|        146 |     7000.00 |
|        147 |     6200.00 |
|        148 |     6100.00 |
|        149 |     6200.00 |
|        201 |     6000.00 |
|        205 |     8300.00 |
+------------+-------------+
```

---

## 6. 查询所有部门的名字，location_id，员工数量和平均工资，并按平均工资降序

```sql
select d.department_name,d.location_id,COUNT(employee_id),AVG(salary)
from employees e 
right join departments d on e.department_id=d.department_id
group by d.department_name,d.location_id  -> select中出现的字段必须出现在group by中
order by AVG(salary); 
```

---

## 7. 查询每个工种、每个部门的部门名、工种名和最低工资

```sql
select department_name,job_id,MIN(salary)
from departments d 
left join employees e on d.department_id=e.department_id
group by department_name,job_id;
```

---
